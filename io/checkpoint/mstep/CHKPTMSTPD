!> @file CHKPTMSTPD
!! @ingroup chkpoint_dns_lin
!! @brief Include file for multistep checkpointing
!! @author Adam Peplinski
!! @date Feb 6, 2017
!=======================================================================
!     module id and name
      integer chpm_id
      character*(*) chpm_name
      parameter(chpm_name='MSTEP')

!     initialisation flag
      logical chpm_ifinit

!     module variable section
!     number of restart sets to keep
      integer chpm_nset
      parameter (chpm_nset=2)

!     max number of snapshots in a single set
      integer chpm_snmax
      parameter  (chpm_snmax=3)

!     current number of snapshots in a single set
!     max ISTEP for cyclic checkpoint writning to avoid collisions at the end of simulation
      integer chpm_nsnap, chpm_nstep

!     time step for old simulation (used during restart)
      real chpm_dtstep(chpm_snmax)

!     wall time of given step      
      real chpm_wtstep(chpm_snmax)

!     max number of files in a snapshot (DNS, perturbation, mhd..)
      integer chkptnfmax
      parameter (chkptnfmax=2)

!     write and read reastart file set number and the reset marker
!     the reset marker is necessayr for dependencies between checkpointing routines
!     form different modules; the only rule should be that chkpt_main should
!     called first
!     Keep it in common block, so other subroutines can access it.
!     Important!!! Do not modify it elswere!!!
      integer chpm_set_o, chpm_set_i, chpm_reset

!     common blocks
      common /CHKPTMFI/ chpm_id, chpm_nsnap, chpm_nstep

      common /CHKPTMFR/ chpm_dtstep, chpm_wtstep

      common /RST_SET/ chpm_set_o, chpm_set_i, chpm_reset
      
      common /CHKPTMFL/ chpm_ifinit
